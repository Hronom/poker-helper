box: mies/java7-oracle@0.0.1

build:
    steps:
        - script:
                name: install additions
                code: |-
                    sudo apt-get update -y
                    sudo apt-get install -y python-software-properties build-essential
                    sudo apt-get install -y libgd2-xpm ia32-libs ia32-libs-multiarch
        - script:
            name: maven build
            code: "mvn clean install"

deploy:
    steps:
        - script:
            name: get version from maven
            code: export APP_VERSION=$(mvn org.apache.maven.plugins:maven-help-plugin:2.1.1:evaluate -Dexpression=project.version | sed -n -e '/^\[.*\]/ !{ /^[0-9]/ { p; q } }')
        - github-create-release:
            token: $GITHUB_TOKEN
            tag: $APP_VERSION
            title: Application $APP_VERSION
            draft: true